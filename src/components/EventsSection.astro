---
import { events } from "../data/events";
---

<section
  id="events"
  class="py-24 relative overflow-hidden bg-gradient-to-b from-white to-indigo-50"
>
  <div
    class="absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none"
  >
    <div
      class="absolute -top-24 -left-24 w-96 h-96 bg-purple-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30"
    >
    </div>
    <div
      class="absolute top-1/3 -right-24 w-96 h-96 bg-indigo-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30"
    >
    </div>
    <div
      class="absolute -bottom-24 left-1/3 w-96 h-96 bg-pink-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30"
    >
    </div>

    <svg
      class="absolute top-0 right-0 w-1/2 h-1/2 transform translate-x-1/4 -translate-y-1/4 text-indigo-100 opacity-20"
      viewBox="0 0 200 200"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill="currentColor"
        d="M42.8,-68.9C54.9,-63.2,63.7,-49.3,70.8,-34.4C77.8,-19.6,83,-3.7,79.8,10.2C76.7,24.2,65.1,36.2,53.3,45C41.5,53.7,29.5,59.2,15.8,66.7C2.2,74.3,-13.1,83.9,-27.4,82.1C-41.8,80.3,-55.2,67.2,-64,52.3C-72.7,37.4,-76.9,20.7,-78.3,3.5C-79.7,-13.7,-78.3,-31.4,-69.2,-44C-60.2,-56.6,-43.5,-64.1,-28.3,-68.6C-13.2,-73.2,0.5,-74.7,15.4,-73.1C30.3,-71.5,48.4,-66.9,42.8,-68.9Z"
        transform="translate(100 100)"></path>
    </svg>

    <svg
      class="absolute bottom-0 left-0 w-1/2 h-1/2 transform -translate-x-1/4 translate-y-1/4 text-purple-100 opacity-20"
      viewBox="0 0 200 200"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill="currentColor"
        d="M47.7,-73.2C59.9,-67.3,67,-49.7,72.1,-32.5C77.2,-15.4,80.3,1.3,75.9,15.9C71.5,30.6,59.7,43.1,46.7,53.9C33.7,64.7,19.3,73.7,3.1,71.7C-13.1,69.7,-30.9,56.7,-43.2,42.7C-55.4,28.6,-62,13.3,-65.6,-4.2C-69.1,-21.7,-69.5,-41.5,-60,-54.8C-50.4,-68.1,-30.9,-75,-11.9,-78.2C7,-81.3,24.4,-80.6,35.5,-74.1C46.6,-67.7,51.4,-56.3,47.7,-73.2Z"
        transform="translate(100 100)"></path>
    </svg>
  </div>

  <div class="container mx-auto px-4 relative z-10">
    <div class="text-center mb-16">
      <div class="inline-block relative mb-3">
        <span
          class="absolute inset-0 rounded-full bg-gradient-to-r from-indigo-600 to-purple-600 blur-lg opacity-70 -z-10"
        ></span>
        <h3
          class="relative px-8 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-full text-sm font-bold tracking-wider shadow-lg z-10"
        >
          SIDE EVENTS
        </h3>
      </div>
      <h2 class="text-5xl font-bold mb-4 uppercase tracking-wider">
        Experience The Magic
      </h2>
      <div
        class="w-24 h-1 bg-gradient-to-r from-indigo-500 to-purple-500 mx-auto mb-6"
      >
      </div>
      <p class="max-w-2xl mx-auto text-gray-600">
        Immerse yourself in a world of creativity and talent with these
        exhilarating performances and competitions.
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-7xl mx-auto">
      {
        events.map((event, index) => (
          <div class="bg-white rounded-2xl overflow-hidden shadow-xl border border-indigo-50 transform transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl flex flex-col h-full">
            <div
              class={`relative h-36 bg-gradient-to-r from-indigo-600 to-purple-600 overflow-hidden`}
            >
              {event.icon && (
                <div class="absolute left-4 top-1/2 transform -translate-y-1/2 w-20 h-20 rounded-full bg-white/10 flex items-center justify-center">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="w-10 h-10 text-white"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                  >
                    <Fragment set:html={event.icon} />
                  </svg>
                </div>
              )}

              <div class="absolute inset-0 bg-gradient-to-b from-black/40 to-black/70">
                <div class="absolute bottom-0 left-0 right-0 p-4 text-center">
                  <span class="bg-white/20 text-white px-3 py-1 rounded-full text-xs backdrop-blur-sm border border-white/30">
                    {event.category}
                  </span>
                  <h3 class="text-2xl font-bold text-white mt-2">
                    {event.title}
                  </h3>
                </div>
              </div>
            </div>

            <div class="p-5 flex flex-col flex-grow">
              <div class="flex flex-col md:flex-row gap-4 mb-4 flex-grow">
                <div class="w-full md:w-1/3">
                  <div class="bg-gray-100 rounded-lg h-48 overflow-hidden flex items-center justify-center">
                    {event.poster ? (
                      <img
                        src={event.poster}
                        alt={`${event.title} poster`}
                        class="w-full h-full object-cover"
                      />
                    ) : (
                      <div class="text-gray-400 text-sm text-center p-4">
                        Poster
                      </div>
                    )}
                  </div>
                </div>

                <div class="w-full md:w-2/3 flex flex-col">
                  <div class="flex-grow min-h-[10rem] max-h-48 overflow-y-auto pr-1">
                    {event.quote && (
                      <p class="text-sm italic text-gray-700 mb-3 border-l-3 border-indigo-400 pl-3">
                        "{event.quote}"
                      </p>
                    )}

                    <p class="text-gray-600 text-sm mb-4">
                      {event.description}
                    </p>
                  </div>
                  {event.guidelines.length > 0 && (
                    <div class="mt-2">
                      <button
                        class="text-indigo-600 hover:text-indigo-800 text-sm font-medium flex items-center gap-2 mb-3 guidelines-toggle"
                        data-event-id={`event-${index}`}
                      >
                        <span>View Guidelines</span>
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          class="w-4 h-4 chevron-icon"
                          fill="none"
                          viewBox="0 0 24 24"
                          stroke="currentColor"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M19 9l-7 7-7-7"
                          />
                        </svg>
                      </button>

                      <div
                        class="guidelines-content hidden bg-indigo-50 rounded-lg p-4 mb-4"
                        id={`event-${index}-guidelines`}
                      >
                        <h4 class="text-md font-bold text-indigo-700 mb-3">
                          Event Guidelines
                        </h4>
                        <ul class="space-y-2">
                          {event.guidelines.map((guideline) => (
                            <li class="flex items-start">
                              <span class="flex-shrink-0 w-5 h-5 rounded-full bg-indigo-100 text-indigo-700 flex items-center justify-center mr-2 mt-0.5">
                                <span class="font-semibold text-xs">
                                  {guideline.index}
                                </span>
                              </span>
                              <span class="text-gray-700 text-sm">
                                <span class="font-semibold">
                                  {guideline.title}:
                                </span>{" "}
                                {guideline.description}
                              </span>
                            </li>
                          ))}
                        </ul>
                      </div>
                    </div>
                  )}
                </div>
              </div>

              <div class="pt-3 mt-auto border-t border-gray-100">
                <div class="text-center mt-3">
                  <a
                    href="#"
                    class="inline-block px-5 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white text-sm font-semibold rounded-lg shadow-md hover:shadow-lg transform transition-all duration-300 hover:-translate-y-1 w-full sm:w-auto"
                  >
                    Register Now
                  </a>
                </div>
              </div>
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const toggleButtons = document.querySelectorAll(".guidelines-toggle");

    toggleButtons.forEach((button) => {
      button.addEventListener("click", () => {
        const eventId = button.getAttribute("data-event-id");
        const guidelinesContent = document.getElementById(
          `${eventId}-guidelines`,
        );
        const chevronIcon = button.querySelector(".chevron-icon");

        guidelinesContent?.classList.toggle("hidden");

        const buttonText = button.querySelector("span");
        if (guidelinesContent?.classList.contains("hidden")) {
          if (buttonText) {
            buttonText.textContent = "View Guidelines";
          }
          if (chevronIcon) {
            chevronIcon.innerHTML =
              '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />';
          }
        } else {
          if (buttonText) {
            buttonText.textContent = "Hide Guidelines";
          }
          if (chevronIcon) {
            chevronIcon.innerHTML =
              '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" />';
          }
        }
      });
    });
  });
</script>

<style>
  .overflow-y-auto {
    scrollbar-width: thin;
    scrollbar-color: rgba(79, 70, 229, 0.3) transparent;
  }

  .overflow-y-auto::-webkit-scrollbar {
    width: 4px;
  }

  .overflow-y-auto::-webkit-scrollbar-track {
    background: transparent;
  }

  .overflow-y-auto::-webkit-scrollbar-thumb {
    background-color: rgba(79, 70, 229, 0.3);
    border-radius: 6px;
  }
</style>